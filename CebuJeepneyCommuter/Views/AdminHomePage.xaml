<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:CebuJeepneyCommuter.ViewModels"
             x:Class="CebuJeepneyCommuter.Views.AdminHomePage"
             Title="Admin Home Page">

    <ContentPage.BindingContext>
        <viewmodel:AdminHomeViewModel />
    </ContentPage.BindingContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <StackLayout Grid.Column="0" 
                     BackgroundColor="LightGray" 
                     Padding="10"
                     Spacing="15">
            <Label Text="ADMIN DASHBOARD"
                   TextColor="Black"
                   FontSize="20"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"/>

            <Button Text="Change Minimum Rate"
                    Clicked="OnChangeMinimumRateClicked" />
            <Button Text="Create New Route"
                    Clicked="OnCreateNewRouteClicked" />
            <Button Text="Manage Users"
                    Clicked="OnManageUsersClicked" />
            <Button Text="Log Out"
                    Clicked="OnLogoutClicked"
                    Margin="0,20,0,0"
                    BackgroundColor="Blue"
                    TextColor="White"/>
        </StackLayout>

        <!-- Main Content -->
        <ScrollView Grid.Column="1" Padding="20">
            <StackLayout Spacing="20">

                <!-- Minimum Rate View -->
                <ContentView x:Name="MinimumRateView" 
                             IsVisible="True">
                    <Frame Padding="20" 
                           CornerRadius="10" 
                           BackgroundColor="Blue">
                        <StackLayout Spacing="10">
                            <Label Text="Change Minimum Rate"
                   FontSize="22"
                   FontAttributes="Bold"
                   HorizontalOptions="Start"
                   LineBreakMode="NoWrap"
                   TextColor="Black" />

                            <Label Text="Vehicle Type:" 
                                   TextColor="Black"/>
                            <Picker Title="Select Vehicle Type"
                                    TextColor="Black"
                                    ItemsSource="{Binding VehicleTypes}"
                                    SelectedItem="{Binding SelectedVehicleType}" 
                                    BackgroundColor="White"/>

                            <Label Text="Route:" 
                                   TextColor="Black"/>
                            <Picker Title="Select Route"
                                    TextColor="Black"
                                    ItemsSource="{Binding FilteredRoutes}"
                                    ItemDisplayBinding="{Binding Code}" 
                                    SelectedItem="{Binding SelectedRoute}"
                                    BackgroundColor="White"/>

                            <Label Text="New Minimum Rate:"
                                   TextColor="Black"/>
                            <Entry x:Name="minimumRateEntry"
                                   Placeholder="₱ :"
                                   TextColor="Black"
                                   Text="{Binding NewRate}"
                                   Keyboard="Numeric"
                                   BackgroundColor="White" />

                            <StackLayout Orientation="Horizontal"
                         HorizontalOptions="Center"
                         Spacing="20"
                         Margin="0,10,0,0">
                                <Button Text="Update Rate"
                                         Command="{Binding UpdateRateCommand}"/>
                                <Button Text="Cancel" />
                            </StackLayout>
                        </StackLayout>
                    </Frame>
                </ContentView>


                <!-- Create Route View -->
                <ContentView x:Name="CreateRouteView" 
                             IsVisible="False">
                    <Frame Padding="20" 
                           CornerRadius="10" 
                           BackgroundColor="Blue">
                        <StackLayout Spacing="10">
                            <Label Text="Create New Route"
                                   TextColor="Black"
                                   FontSize="22"
                                   FontAttributes="Bold" />

                            <Label Text="Route Code:"
                                    TextColor="Black"/>
                            <Entry x:Name="routeCodeEntry" 
                                   Placeholder="Enter Route Code"
                                    Text="{Binding NewRouteCode}"
                                   TextColor="Black"
                                   BackgroundColor="White"/>

                            <Label Text="Vehicle Type:" 
                                   TextColor="Black"/>
                            <Picker Title="Select Vehicle"
                                    TextColor="Black"
                                    ItemsSource="{Binding VehicleTypes}"
                                    SelectedItem="{Binding SelectedCreateRouteVehicleType}"
                                    BackgroundColor="White"/>

                            <Label Text="Stops:"
                                   TextColor="Black"/>
                            <Grid ColumnSpacing="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Picker x:Name="stop1Picker"
                                        Title="Start Stop"
                                        BackgroundColor="White"
                                        Grid.Column="0"
                                        ItemsSource="{Binding Stops}"
                                        SelectedItem="{Binding SelectedStop1}"
                                        TextColor="Black"/>
                                <Picker x:Name="stop2Picker"
                                        Title="End Stop"
                                        BackgroundColor="White"
                                        Grid.Column="1"
                                        ItemsSource="{Binding Stops}"
                                        SelectedItem="{Binding SelectedStop2}"
                                        TextColor="Black"/>
                            </Grid>
                            <!--<Button Text="Add Stop" 
                                    HorizontalOptions="End"
                                     Command="{Binding AddStopCommand}"/>-->

                            <Label Text="Minimum Price:" 
                                   TextColor="Black"/>
                            <Entry x:Name="minimumPriceEntry"
                                   Placeholder="₱ :"
                                   Keyboard="Numeric"
                                   Text="{Binding MinimumPrice}"
                                   TextColor="Black"
                                   BackgroundColor="White"/>

                            <StackLayout Orientation="Horizontal" 
                                         HorizontalOptions="Center" 
                                         Spacing="20" 
                                         Margin="0,10,0,0">
                                <Button Text="Save Route"
                                        Command="{Binding SaveRouteCommand}"/>
                                <Button Text="Cancel" 
                                        Clicked="OnChangeMinimumRateClicked" />
                            </StackLayout>
                        </StackLayout>
                    </Frame>
                </ContentView>

                <!-- Manage Users View -->
                <ContentView x:Name="ManageUsersView" 
                             IsVisible="False">
                    <Frame Padding="20" 
                           CornerRadius="10"
                           BackgroundColor="Blue">
                        <StackLayout Spacing="10">
                            <Label Text="Manage Users"
                                   FontSize="22"
                                   FontAttributes="Bold"
                                   TextColor="Black"/>

                            <CollectionView ItemsSource="{Binding Users}"
                                            SelectionMode="Single"
                                            SelectedItem="{Binding SelectedUser}"
                                            HeightRequest="150">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Frame Padding="10"
                                               Margin="5" 
                                               BackgroundColor="White" 
                                               HasShadow="False">
                                            <StackLayout>
                                                <Label Text="{Binding Name}" 
                                                       TextColor="Black"
                                                       FontAttributes="Bold"/>
                                                <Label Text="{Binding Email}"
                                                       TextColor="Black"
                                                       FontSize="12"/>
                                            </StackLayout>
                                        </Frame>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                            <Entry Placeholder="Name" 
                                   Text="{Binding NewUserName}" 
                                   TextColor="Black"
                                   BackgroundColor="White"/>
                            <Entry Placeholder="Email"
                                   Text="{Binding NewUserEmail}" 
                                   TextColor="Black"
                                   Keyboard="Email" 
                                   BackgroundColor="White"/>
                            <Entry Placeholder="Phone Number" 
                                   Text="{Binding NewUserPhone}" 
                                   TextColor="Black"
                                   Keyboard="Telephone" 
                                   BackgroundColor="White"/>
                            <Entry Placeholder="Password" 
                                   Text="{Binding NewUserPassword}" 
                                   TextColor="Black"
                                   IsPassword="True" 
                                   BackgroundColor="White"/>

                            <StackLayout Orientation="Horizontal" 
                                         HorizontalOptions="Center" 
                                         Spacing="10" 
                                         Margin="0,10,0,0">
                                <Button Text="Add User" 
                                        Command="{Binding AddUserCommand}" />
                                <Button Text="Update User" 
                                        Command="{Binding UpdateUserCommand}" />
                                <Button Text="Delete User" 
                                        Command="{Binding DeleteUserCommand}" />
                            </StackLayout>
                        </StackLayout>
                    </Frame>
                </ContentView>

            </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
